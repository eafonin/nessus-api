# Scanner instance configuration
#
# Environment variable substitution supported using ${VAR_NAME} syntax
#
# IMPORTANT: Nessus runs through VPN gateway (network_mode: service)
# - Containers connect via vpn-gateway hostname on nessus_net network
# - vpn-gateway exposes Nessus on port 8834
# - nessus-pro container shares network with vpn-gateway

nessus:
  - instance_id: local
    name: "Local Nessus Scanner"
    url: ${NESSUS_URL:-https://vpn-gateway:8834}
    username: ${NESSUS_USERNAME:-nessus}
    password: ${NESSUS_PASSWORD:-nessus}
    enabled: true
    max_concurrent_scans: 10

  # Example: Additional Nessus instance
  # - instance_id: remote
  #   name: "Remote Nessus Scanner"
  #   url: ${NESSUS_URL_2:-https://nessus-remote:8834}
  #   username: ${NESSUS_USERNAME_2}
  #   password: ${NESSUS_PASSWORD_2}
  #   enabled: false
  #   max_concurrent_scans: 5

# Future: OpenVAS scanner support
# openvas:
#   - instance_id: openvas-1
#     url: ${OPENVAS_URL}
#     username: ${OPENVAS_USERNAME}
#     password: ${OPENVAS_PASSWORD}
#     enabled: false
